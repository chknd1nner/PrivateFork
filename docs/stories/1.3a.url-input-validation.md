# Story 1.3a: URL Input and Validation

## Status
Approved

## Story
**As a** user,
**I want** to enter a GitHub repository URL with real-time validation feedback,
**so that** I can quickly identify if I've entered a valid repository URL before proceeding.

## Acceptance Criteria
1. The main application view contains a text input field for the public repository URL.
2. A status message appears near the URL field in real-time, indicating if the entered text is a valid GitHub URL.
3. The URL validation logic checks for valid URL format, GitHub domain (github.com), and repository path structure (user/repo).
4. All UI elements adhere to standard macOS design conventions and support both light and dark modes.

## Tasks / Subtasks
- [ ] Expand MainView with repository URL input field (AC: 1, 4)
  - [ ] Add TextField for public repository URL in MainView.swift
  - [ ] Bind URL input to MainViewModel @Published property
  - [ ] Apply standard macOS TextField styling
- [ ] Implement GitHub URL validation logic (AC: 2, 3)
  - [ ] Add URL validation method in MainViewModel
  - [ ] Implement real-time validation with debouncing
  - [ ] Add validation for GitHub domain and repository path structure
  - [ ] Add @Published isValidURL property to MainViewModel
- [ ] Add validation status message display (AC: 2)
  - [ ] Add validation status message display below URL field
  - [ ] Bind status message to MainViewModel @Published property
  - [ ] Implement proper message formatting and styling
- [ ] Ensure macOS design compliance and theme support (AC: 4)
  - [ ] Apply standard macOS spacing and sizing conventions
  - [ ] Test and verify light/dark mode compatibility for URL input components
  - [ ] Apply appropriate macOS TextField and label styling
- [ ] Create comprehensive unit tests
  - [ ] Test URL validation logic with various GitHub URL formats
  - [ ] Test invalid URL scenarios and edge cases
  - [ ] Test real-time validation updates and debouncing
  - [ ] Test @Published property updates for URL and validation status

## Dev Notes

### Previous Story Insights
From Story 1.2: The project successfully implements secure credential management with KeychainService. The MainViewModel already has settings sheet functionality and can be extended. Pay attention to the CustomSecureField implementation pattern used in SettingsView for consistent UI patterns.

### Project Structure
Following the MVVM pattern from the source tree, the URL input and validation components should be organized as:
- **Views/MainView.swift**: Already exists, needs TextField addition [Source: docs/architecture/source-tree.md#views]
- **ViewModels/MainViewModel.swift**: Already exists, needs URL validation logic [Source: docs/architecture/source-tree.md#viewmodels]
- **Models/AppModels.swift**: May need URL validation models [Source: docs/architecture/source-tree.md#models]

### Component Standards
MainView must follow the component template structure with:
- @StateObject for ViewModel ownership (already implemented)
- UI elements bound to @Published properties
- TextField for URL input with real-time validation feedback
[Source: docs/architecture/component-standards.md#component-template]

### Coding Standards Requirements
- **MVVM Pattern**: MainView for display only, MainViewModel contains all logic [Source: docs/architecture/coding-standards.md#critical-coding-rules]
- **@MainActor**: MainViewModel already marked with @MainActor [Source: docs/architecture/coding-standards.md#critical-coding-rules]
- **Asynchronous Operations**: URL validation must use async/await [Source: docs/architecture/coding-standards.md#critical-coding-rules]
- **Result Type**: All validation operations should return Result<Success, Error> [Source: docs/architecture/coding-standards.md#critical-coding-rules]

### Technology Stack
- **Framework**: SwiftUI 5.0+ for UI components [Source: docs/architecture/tech-stack.md]
- **Language**: Swift 5.10+ [Source: docs/architecture/tech-stack.md]
- **Dependencies**: Native Apple frameworks only (Foundation for URL validation) [Source: docs/architecture/tech-stack.md]

### URL Validation Implementation Details
Implement GitHub URL validation logic to check:
- Valid URL format
- GitHub domain (github.com)
- Repository path structure (user/repo)
- Real-time validation with debouncing to avoid excessive validation calls
- Clear error messages for invalid formats

### State Management Pattern
MainViewModel should include these @Published properties for URL functionality:
- @Published var repoURL: String = ""
- @Published var isValidURL: Bool = false
- @Published var urlValidationMessage: String = ""
[Source: docs/architecture/state-management.md#state-management-template]

### Naming Conventions
- **Views**: MainView.swift (already exists) [Source: docs/architecture/component-standards.md#naming-conventions]
- **ViewModels**: MainViewModel.swift (already exists) [Source: docs/architecture/component-standards.md#naming-conventions]

### Testing

**Test File Locations:**
- PrivateForkTests/ViewModels/MainViewModelTests.swift (already exists, needs expansion)
[Source: docs/architecture/testing-requirements.md#component-test-template]

**Test Standards:**
- All ViewModels require comprehensive unit tests following Given-When-Then structure using XCTest
- Test coverage must include URL validation scenarios with valid/invalid GitHub URLs
- Test real-time validation updates and debouncing behavior
[Source: docs/architecture/testing-requirements.md#testing-best-practices]

**Testing Frameworks and Patterns:**
- Framework: XCTest (native macOS testing framework)
- Pattern: Given-When-Then structure for test organization
- Async Testing: Use expectation-based testing for async operations

**Specific Testing Requirements for This Story:**
- URL validation: Test valid/invalid GitHub URLs, edge cases, and real-time validation
- Debouncing: Test that validation doesn't trigger on every keystroke
- State management: Test @Published property updates for URL and validation status
- Message display: Test validation message content and formatting

## Change Log
| Date       | Version | Description                           | Author |
|------------|---------|---------------------------------------|--------|
| 2025-07-16 | 0.1     | Initial focused story from 1.3 split | SM     |

## Dev Agent Record
*This section is populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent QA review of the completed story implementation*