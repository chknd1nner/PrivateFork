# **Coding Standards**

## **Critical Coding Rules**

All code generated by developer agents MUST adhere to the following standards:

1. **MVVM Pattern**: Strictly separate concerns. Views are for display only. ViewModels contain all logic and state. Models are for data representation.  
2. **Protocol-Oriented Programming (POP)**: All services (e.g., GitService, GitHubService) must be abstracted behind protocols (GitServiceProtocol). ViewModels will depend on the protocols, not concrete implementations.  
3. **Dependency Injection**: Services will be injected into ViewModels during initialization. This is crucial for testability, allowing mock services to be injected during unit tests.  
4. **State Management**: Use @StateObject to create and own ViewModel instances in the View. Use @Published within ViewModels to expose properties to the View, allowing the UI to reactively update.  
5. **Asynchronous Operations**: All potentially long-running operations (shell commands, network requests) **must** be performed asynchronously using async/await. This prevents blocking the main thread and keeps the UI responsive.  
6. **Single Responsibility Principle**: Each file and class should have a single, clear purpose. For example, Keychain logic belongs in KeychainService.swift, not in a ViewModel.  
7. **Result Type for Outcomes**: All service operations that can fail must return a Result\<Success, Error\> type. This forces explicit and safe error handling in the ViewModels.  
8. **Comprehensive Unit Tests**: Every public function in a ViewModel or Service must have corresponding unit tests. Tests will follow a **Given-When-Then** structure for clarity. Mocks will be used for all external dependencies.  
9. **Custom View Modifiers**: For any repeated UI styling (e.g., a specific button style, text formatting), create a custom ViewModifier to ensure consistency and a single source of truth.  
10. **@MainActor**: All ViewModels must be marked with @MainActor to ensure UI updates happen on the main thread.

## **Quick Reference**

- **Build Project**: Use XcodeBuildMCP tool: build_mac_proj  
- **Run Tests**: Use XcodeBuildMCP tool: test_macos_proj, fallback: Execute `xcodebuild test -scheme PrivateFork -quiet`
- **Lint Code**: Run swiftlint from the command line in the project root.  
- **File Naming**: Follow conventions outlined in Component Standards.  
- **Project-specific Patterns**: Use dependency injection for all services as shown in the templates.